{% extends 'base.html.twig' %}

{% set currentPath = path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) %}
{% set currentLevelMenuItems = generate_product_category_one_level_menu(productCategory) %}

{% block title %}{{ productCategory.name }}{% endblock %}

{% block body %}
    <main class="main">
        <div class="container">
            <div class="layout">
                <div class="layout-content">
                    {% include 'blocks/breadcrumbs.html.twig' with {'breadcrumbs': build_breadcrumbs(productCategory.name, productCategory)} %}
                    <h1 class="main-title">{{ productCategory.name }}</h1>
                    {% if currentLevelMenuItems %}
                        <nav class="inline-nav">
                            <ul class="inline-nav-list">
                                <li class="inline-nav-item">
                                    {% set productUrl = generate_product_category_url(productCategory) %}
                                    <a class="inline-nav-link" href="{{ productUrl }}"
                                       aria-current="{% if productUrl == currentPath %}page{% endif %}">{{ productCategory.name }}</a>
                                </li>
                                {% for currentLevelMenuItem in currentLevelMenuItems %}
                                    <li class="inline-nav-item">
                                        <a class="inline-nav-link" href="{{ currentLevelMenuItem.url }}"
                                           aria-current="{% if currentLevelMenuItem.url == currentPath %}page{% endif %}">{{ currentLevelMenuItem.name }}</a>
                                    </li>
                                {% endfor %}
                            </ul>
                        </nav>
                    {% endif %}

                    <div class="content">
                        {{ productCategory.summary|raw }}
                    </div>
                    {% if products %}
                        <div class="product-cards">
                            {% for product in products %}
                                <div class="product-card">
                                    <div class="product-card-image">
                                        <img src="{{ asset('uploads/product/' ~ product.images|first) }}"
                                             alt="{{ product.name }}">
                                    </div>
                                    <h4 class="product-card-title">
                                        <a class="product-card-link"
                                           href="{{ generate_product_url(product) }}">{{ product.name }}</a>
                                    </h4>
                                    <div class="product-card-desc">
                                        {{ product.summary|raw|nl2br }}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}

                    <div class="content">
                        {{ productCategory.description|raw }}
                    </div>

                    {% if productCategory.equipments %}
                        <section class="featured featured--primary">
                            <h2 class="featured-title">Equipment</h2>

                            <div class="featured-box">
                                <div class="listing">
                                    {% for equipment in productCategory.equipments %}
                                        <div class="listing-card">
                                            <div class="listing-card-image">
                                                <img src="{{ asset('uploads/product/' ~ equipment.images|first) }}"
                                                     alt="">
                                            </div>
                                            <h4 class="listing-card-title">
                                                <a class="listing-card-link"
                                                   href="{{ generate_product_url(equipment) }}">{{ equipment.name }}</a>
                                            </h4>
                                            <div class="listing-card-desc">
                                                {{ equipment.summary|raw|nl2br }}
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>

                            </div>
                        </section>
                    {% endif %}

                    {% if productCategory.technology %}
                        <section class="featured featured--secondary">
                            <h2 class="featured-title">Technology</h2>
                            <div class="featured-box content">
                                <h3>{{ productCategory.technology.name }}</h3>

                                {{ productCategory.technology.summary|nl2br }} <br>
                                <a class="button" href="{{ generate_technology_url(productCategory.technology) }}">Read
                                    more</a>
                            </div>
                        </section>
                    {% endif %}
                </div>

                {% include 'menu/left_sidebar.html.twig' with {'menuItems': generate_product_category_menu() } %}
            </div>
        </div>
    </main>
{% endblock %}
